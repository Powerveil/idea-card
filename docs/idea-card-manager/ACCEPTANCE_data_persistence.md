# 验收报告：数据管理增强与本地持久化

## 1. 背景
为了提高数据的安全性和可移植性，以及方便开发调试，需要增强系统的数据管理能力。
- **需求**：支持将数据导出为 JSON 文件备份，支持从 JSON 文件导入数据并解决冲突，支持将数据同步到本地文件系统（开发环境）。

## 2. 解决方案

### 2.1 增强的导入/导出功能
- **导出**：
  - 提供“导出”按钮，将当前所有卡片数据打包为 JSON 文件下载。
  - 文件名包含当前日期，便于版本管理。
- **导入**：
  - 提供“导入”按钮，选择 JSON 文件。
  - **冲突检测**：自动识别文件中与现有数据标题相同的卡片。
  - **交互式选择**：弹出 `ImportModal` 模态框，将数据分类展示为“新卡片”和“冲突卡片”。
  - **智能处理**：用户可自由勾选需要导入的卡片，系统自动为导入的卡片生成新 ID，避免 ID 冲突。

### 2.2 本地文件持久化（Simple DB）
- **机制**：利用 Vite 中间件实现了一个简单的文件系统数据库。
- **实现**：
  - 在项目根目录维护 `data.json` 文件作为单一数据源。
  - `GET /api/data`：读取本地文件数据，用于应用启动时初始化。
  - `POST /api/data`：将前端状态变更实时写入本地文件。
- **双向同步**：应用启动时优先从服务器（本地文件）加载数据，若失败则回退到 `localStorage`。数据变更时同时写入 `localStorage` 和服务器。

### 2.3 用户体验优化
- **删除确认**：在删除卡片前增加确认弹框，防止误操作。
- **头部布局**：优化了 Header 区域的布局，整合了统计信息和数据操作按钮。

## 3. 验证
- [x] **导出功能**：点击导出能下载正确的 JSON 文件。
- [x] **导入流程**：
  - [x] 选择文件后正确解析 JSON。
  - [x] 模态框正确显示新卡片和冲突卡片分类。
  - [x] 勾选/取消勾选功能正常。
  - [x] 确认导入后，数据正确追加到列表，且无 ID 冲突。
- [x] **持久化**：
  - [x] 新增/修改/删除卡片后，根目录 `data.json` 实时更新。
  - [x] 重启开发服务器后，数据能从 `data.json` 恢复。
- [x] **误删保护**：点击删除按钮弹出确认框，取消后不删除。

## 4. 技术总结
- **新组件**：`src/components/ImportModal.vue`
- **Vite 配置**：`vite.config.ts` 中添加自定义中间件处理文件读写。
- **Store 更新**：`useIdeaStore` 增加了与后端 API 交互的逻辑及高级导入逻辑。
